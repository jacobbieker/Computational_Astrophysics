Theta Muscae is a triple star with the masses of WR48: 60, O6: 40, and O9.5III: 20 solar masses at for the purposes of the simulation we age them to 4 Gyr where there masses are 40, 29, 20 solar masses respectively. From the literature we got that the period of the orbit of Wr48 and the O6 star is 19 days and that together with the O9.5III completes one orbit every five years. 

In order to accurately simulate a three-body star system you need to take in to account stellar evolution in addition to the gravitational simulator. Our task was to figure out what is the best method to integrate the stellar evolution and the gravity simulation. In order to accomplish this, we compare three integrator methods, three gravity solvers (Huayno, Hermite, and SmallN) across many different timesteps.
Temporal discretization involves integration of every term in differential equations over time step.

We plot the results for four intergation methods; diagnostic where there is no stellar evolution, stellar_first: start with stellar evolution, and gravity_first: gravity simulator goes first, and the interlaced temporal discretization method. The interlaced temporal discretization method is when both the gravity simulator and the stellar evolution simulator are synchronized at regular time intervals
Allow the time-step to depend on the rate of mass loss and prevent the total mass loss from exceeding a limit set by the stellar_mass_fraction_loss variable, which ranged from 0.001 to 0.000001 of the total stellar mass of any of the stars.

We experimented with dynamical timesteps based off a maximum stellar mass loss of 0.001, 0.0001, 0.00005, 0.00001, 0.000005, 0.0000001 of the total stellar mass for any of the given stars. In addition, we experimented with inclinations of 0.573, 28.648, 57.296, and 85.944 degrees. 

Our plot for Timestep vs Walltime shows that the larger the timestep the longer it takes to run, but the amount of time spent in the simulation code vs the AMUSE framework is vastly different based on which gravity code was used and the timestep chosen. For the SmallN code, very little time was spent in the simulation code, instead much more time was spent in the framework once the stellar mass fraction dropped below around 0.0001, while for the Huayno code, the amount of time spent in AMUSE did not suprass the amount of time spent in the simulation code until the stellar mass fraction of less than 0.00002, around an order of magnitude smaller than for the SmallN code.

Huayno
This simulator is simpletic, meaning that it conserves area.
assignment_two/Interesting_Plots.


Because of time constraints, we were not able to run all the codes or all the methods for very long times (> 1200 years) for most of them, but we do have two plots from running Huayno up to a time of 350000 years with a mass loss fraction of 0.001 and inclination of 0.573.
As can be sen in the plots "eccentricity_vs_time_dts=0.00100000_inc=0.573_grav=huayno_method=interlaced.png" and "semimajor_axis_vs_time_dts=0.00100000_inc=0.573_grav=huayno_method=interlaced.png", the code seems to be stable until near the end of the simulation. For both the eccentricity and the semimajor axis, massive changes occur near the end of the simulation,
as seemingly the error adds up during the large timesteps, as during that simulation, there were a total of 11 timesteps, averaging 31818 years each.

Hermite
This simulator is non-simpletic, meaning area is not convserved.
Looking at the ALL_eccentricity vs time at ~60 degrees inclintaion it is you can tell that there is not much difference between the integration techniques interlaced, stellar_first, gravity_first and diagnostic are about what should be expected. From the ALL_eccetricity and ALL_semimajoraxis plots it is clear that across all time steps <= 1 degerees initial inclination is not stable.
There are no major differences ALL_semimajor vs time for all the time steps plots between Huayno and Hermite simulation results other then minor difference that can be seen in the diagnostic (which have not stellar evoltion)plots that show different trends which may mean that the gravity simulations' differences in turn be what causes slight differences in the trends of the other integration methods where stellar evolution does play a role.

You can find the plots discussed here in the assignment_two/Interesting_Plots.

SmallN
Time reversible

The SmallN code is very fast, by far the fastest of any of the gravity codes used in this project. This partly seems to come from SmallN being well suited for N-body tasks with N < 10, so for this system it is well suited. It is a fully time reversible code and so should conserve all relevant quantities.
From the walltime vs timestep plots made, comparing the ones whose filenames include grav=smalln vs those that have grav=huayno, the SmallN code is an order of magnitude or larger faster than the Huayno code and most likely Hermite code as well, since both of those codes seem to run on similar timescales.

You can find the plots discussed here in the assignment_two/Interesting_Plots.

From our test we determined that the interlaced temporal discretization method is the best method. In this case, its output was between the gravity first method and stellar first method, leading us to believe that it is probably more accurate than doing one full time step of the stellar or gravity simulation and then one timestep of the other.
The interlaced method allows for the changes from either of the simulations to affect the other one because both the stellar and gravity simulations obtain updated information from the other during the interlaced timestep.


Across all the gravity simulators we noticed that from the plots of all of the integrations across multiple time steps (All_eccentricity_vs_time and All_semimajor) it is clear that the large time steps, > 0.001 are too big to converge. In addition, the plots inclination vs time for large times 

The optimum time step depends on the mass-loss rate of the star with the strongest wind because that is the star that is the most active.
The optimum time step depends on the initial relative inclination
Average wall clock time does change for lower initial inclination 

